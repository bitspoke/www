@main("Articles") {
    <div ng-app="app" ng-controller="articleCtrl">
        <div class="page-header">
            <div class="btn-group pull-right">
                <button title="List all articles" type="button" class="btn btn-default" ng-class="{'active':state==='listing'}" ng-click="list()"><span class="fa fa-list"></span> List</button>
                <button title="Create new article" type="button" class="btn btn-default" ng-class="{'active':state==='creating'}" ng-click="state='creating'"><span class="fa fa-file-o"></span> Create</button>
            </div>
            <h1>Articles <small>written by our authors</small></h1>
            <alert ng-repeat="alert in alerts" type="{{alert.type}}" close="closeAlert($index)">{{alert.msg}}</alert>
        </div>


        <div ng-switch on="state">
            <div ng-switch-when="listing">
                <div class="list-group">
                    <a class="list-group-item" ng-repeat="article in articles" ng-click="read(article['_id']['$oid'])" href="">
                        <h2>{{article.title}}</h2>
                        <p>{{article.author}} - {{article.date["$date"] | date:"medium"}}</p>
                        <blockquote>{{article.summary}}</blockquote>
                    </a>
                </div>
            </div>

            <div ng-switch-when="reading">
                <h1>{{article.title}}</h1>
                <p>Author: {{article.author}}</p>
                <p>Published: {{article.date["$date"] | date:"medium"}}</p>
                <blockquote>{{article.summary}}</blockquote>
                <div ng-bind-html="marked(article.content) | trust"></div>
            </div>

            <div ng-switch-when="creating">
                <form name="articleForm" novalidate role="form">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="title">Title</label>
                                <div class="input-group">
                                    <input type="text" class="form-control" name="title" placeholder="Enter title" ng-model="newArticle.title" required>
                                    <span class="input-group-btn">
                                        <button class="btn btn-primary" type="button" ng-disabled="articleForm.$invalid" ng-click="create(newArticle)">
                                            <span class="fa fa-save"></span> Save
                                        </button>
                                    </span>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="summary">Summary</label>
                                <textarea class="form-control" style="resize:none" name="summary" rows="4" ng-model="newArticle.summary"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="content">Content</label>
                                <textarea class="form-control" style="resize:none" name="content" rows="32" ng-model="newArticle.content"></textarea>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="content">Preview</label>
                                <div class="article-preview well">
                                    <h1>{{newArticle.title}}</h1>
                                    <blockquote>{{newArticle.summary}}</blockquote>
                                    <div ng-bind-html="marked(newArticle.content) | trust">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

    @* TODO lz-string should resolved as WebJar *@
    <script src="@routes.Assets.at("javascripts/lz-string-1.3.3-min.js")"></script>
    <script src="@routes.Assets.at("lib/angularjs/angular.min.js")"></script>
    <script src="@routes.Assets.at("lib/angular-ui-bootstrap/ui-bootstrap-tpls.min.js")"></script>
    <script src="@routes.Assets.at("lib/marked/marked.js")"></script>
    <script src="@routes.Assets.at("javascripts/app.js")"></script>
    <script src="@routes.Assets.at("javascripts/filters.js")"></script>
    <script src="@routes.Assets.at("javascripts/services.js")"></script>
    <script src="@routes.Assets.at("javascripts/controllers.js")"></script>
}
